<!DOCTYPE html><html><head>
      <title>presentation</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="file:////home/jonah/.vscode-server/extensions/shd101wyy.markdown-preview-enhanced-0.6.2/node_modules/@shd101wyy/mume/dependencies/katex/katex.min.css">
      
      
      
      
      
      
      
      
      
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <style>
  html, body {
    font-family: sans-serif;
    max-width: 100ch;
    margin-left: auto;
    margin-right: auto;
  }

  @media print {
    pre, blockquote {page-break-inside: unset;}
  }
</style>
<h1 class="mume-header" id="a-whirlwind-tour-of-language-o-things">A Whirlwind Tour of <em>Language o&apos; Things</em></h1>

<p>Jonah Sussman<br>
CWID 11966879<br>
CS 503</p>
<h2 class="mume-header" id="table-of-contents">Table of Contents</h2>

<ul>
<li><a href="#1-rationale">1. Rationale</a></li>
<li><a href="#2-crash-course-lot">2. Crash Course: LoT</a></li>
<li><a href="#3-expression-types">3. Expression Types</a>
<ul>
<li><a href="#31-trivial-types-number-string-boolean">3.1 Trivial Types (Number, String, Boolean)</a></li>
<li><a href="#32-semi-trivial-types-nil-symbol">3.2 Semi-trivial Types (Nil, Symbol)</a></li>
<li><a href="#33-non-trivial-types-list-thing-call-primitive-procedure">3.3 Non-trivial Types (List, Thing, Call, Primitive, Procedure)</a></li>
</ul>
</li>
<li><a href="#4-primitives">4. Primitives</a>
<ul>
<li><a href="#41-io">4.1 IO</a></li>
<li><a href="#42-types">4.2 Types</a></li>
<li><a href="#43-arithmetic">4.3 Arithmetic</a></li>
<li><a href="#44-comparison">4.4 Comparison</a></li>
<li><a href="#45-logic">4.5 Logic</a></li>
<li><a href="#46-ordering">4.6 Ordering</a></li>
<li><a href="#47-control-flow">4.7 Control Flow</a></li>
<li><a href="#48-procedures">4.8 Procedures</a></li>
<li><a href="#49-variables">4.9 Variables</a></li>
<li><a href="#410-thing-modification">4.10 Thing Modification</a></li>
</ul>
</li>
<li><a href="#5-examples">5. Examples</a>
<ul>
<li><a href="#51-bottles-of-milk">5.1 Bottles of Milk</a></li>
<li><a href="#52-higher-lower-guessing-game">5.2 Higher-Lower Guessing Game</a></li>
<li><a href="#53-tail-call-optimization">5.3 Tail-call-optimization</a></li>
<li><a href="#54-vector">5.4 Vector</a></li>
<li><a href="#55-tree-traversal">5.5 Tree Traversal</a></li>
</ul>
</li>
<li><a href="#6-grammar">6. Grammar</a></li>
</ul>
<h2 class="mume-header" id="1-rationale">1. Rationale</h2>

<p>These days, it&apos;s incredibly easy to find programming languages that solve all sorts of problems. Highly-expressive languages like Haskell can tersely compute all sorts of problems while writing as few lines of code. Other languages concern themselves with squeezing the most amount of performance of the machine as possible. C++, for instance, gives you near full access to the machine&apos;s memory - safety be damned. Python is another language which aims to be extremely friendly to beginners, while still maintaining some semblance of performance.</p>
<p>Unfortunately, all of these aforementioned programming languages subscribe to certain dogmatic principles - often at to the detriment of the programmer. The creators of these languages take the beautiful problem space of all possible programs, and section off areas into clearly defined &quot;DO&quot;s and &quot;DON&apos;T&quot;s according to their beliefs. Ask any Java programmer what a factory is and they&apos;ll want to tear their hair out.</p>
<p>It&apos;s often said that limitation breeds creativity, but why should we as software engineers limit ourselves so greatly. I don&apos;t ever recall a civil engineer being thrilled that they were forced to build a bridge using popsicle sticks, or a mechanical engineer being ecstatic that they could only use a slide rule and compass. Why should our field be any different?</p>
<p>Enter <em>Language o&apos; Things</em>, or LoT. LoT aims to be a highly extensible, multi-paradigm language that doesn&apos;t box you in. It&apos;s small, in order to get out of your way, but highly-expressive.</p>
<p>If you want to write in a functional style, you can! Functions are first-class. If you want to write in a data-oriented style, you can! Most data types are passed via reference. If you want to write in an object-oriented-style, you can! Things have methods which you can implicitly pass itself to, and Meta-Things act like superclasses.</p>
<h2 class="mume-header" id="2-crash-course-lot">2. Crash Course: LoT</h2>

<p>The following is a simple crash course in LoT to get you familiar with the language. Following sections will expand on this file later.</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/2_crash_course.lot</span>
<span class="token comment">#######################################</span>
<span class="token comment">#### 1. Expressions and data types ####</span>
<span class="token comment">#######################################</span>

<span class="token comment"># Comments start with a &apos;#&apos; symbol</span>
<span class="token comment"># Everything in LoT is an expression</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">)</span> <span class="token comment"># Returns nil</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span> <span class="token comment"># Can have multiple expressions per line</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;B&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">)</span> <span class="token comment"># Optionally put &apos;;&apos; after expressions for clarity</span>

<span class="token comment"># Variables are dynamically typed</span>
<span class="token keyword">let </span>dynamic <span class="token operator">=</span> <span class="token number">4</span>
dynamic <span class="token operator">=</span> <span class="token string">&quot;Happy birthday!&quot;</span> <span class="token comment"># Valid</span>

<span class="token comment"># There are 10 data types in LoT</span>
                         <span class="token comment"># 1. Symbols, like &apos;x&apos;, &apos;variable_name&apos;, ...</span>
<span class="token keyword">let </span>num   <span class="token operator">=</span> <span class="token number">42</span>           <span class="token comment"># 2. Numbers, IEEE double precision float</span>
<span class="token keyword">let </span>str   <span class="token operator">=</span> <span class="token string">&quot;Hey y&apos;all!&quot;</span> <span class="token comment"># 3. String, immutable</span>
<span class="token keyword">let </span>bool  <span class="token operator">=</span> <span class="token keyword keyword-true">true</span>         <span class="token comment"># 4. Booleans, &apos;true&apos; or &apos;false&apos;</span>
str <span class="token operator">=</span> <span class="token keyword keyword-nil">nil</span>                <span class="token comment"># 5. nil. Thanks to smart pointers, will free memory</span>
<span class="token keyword">let </span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>        <span class="token comment"># 6. Lists. WARNING, these do NOT behave like you think.</span>
                         <span class="token comment">#    If you want something more traditional, use Things.</span>
<span class="token keyword">let </span>prim <span class="token operator">=</span> __add         <span class="token comment"># 7. Primitives, built-in functions like __mul, __while, etc...</span>
<span class="token keyword">let </span>fact <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>n<span class="token punctuation">]</span>       <span class="token comment"># 8. Procedures, user-defined functions</span>
  <span class="token keyword keyword-if">if</span> n <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token keyword keyword-then">then</span> <span class="token number">1</span> <span class="token keyword keyword-else">else</span> n <span class="token operator">*</span> <span class="token function">fact</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-end">end</span>
<span class="token keyword">let </span>call1 <span class="token operator">=</span> <span class="token function">__mul</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment"># 9. Calls, which consist of a Primitive or Procedure </span>
<span class="token keyword">let </span>call2 <span class="token operator">=</span> <span class="token function">fact</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>      <span class="token comment">#    and a list of expressions to use as args</span>
<span class="token keyword">let </span>thing <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token comment"># 10. Things, which have fields. Fields have keys and values</span>
  <span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>                <span class="token comment">#    Keys and values can be any expression.</span>
  <span class="token punctuation">[</span><span class="token string">&quot;y&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;happy b-day!&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">123</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">,</span>          <span class="token comment"># Trailing comma allowed</span>
<span class="token punctuation">}</span>
thing<span class="token punctuation">.</span>y                  <span class="token comment"># Two ways to access properties</span>
thing<span class="token punctuation">[</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">]</span>               <span class="token comment"># Symbols are converted to string keys</span>

<span class="token comment"># You can convert to Booleans, Strings, and Numbers by using their respective</span>
<span class="token comment"># functions. If the conversion fails, it returns nil.</span>

<span class="token keyword">let </span>str_to_num  <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>   <span class="token comment"># 123</span>
<span class="token keyword">let </span>num_to_bool <span class="token operator">=</span> <span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>    <span class="token comment"># true</span>
<span class="token keyword">let </span>bool_to_str <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>    <span class="token comment"># &quot;true&quot;</span>
<span class="token keyword">let </span>uh_oh_num   <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token string">&quot;What?&quot;</span><span class="token punctuation">)</span> <span class="token comment"># nil</span>

<span class="token comment"># You can inspect the type of an expression by using the type primitive. It</span>
<span class="token comment"># returns a string with the type.</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># &quot;STRING&quot;</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment"># &quot;NUMBER&quot;</span>
<span class="token function">println</span><span class="token punctuation">(</span>__add<span class="token punctuation">)</span>       <span class="token comment"># &quot;PRIMITIVE&quot;</span>

<span class="token comment">##########################################</span>
<span class="token comment">#### 2. Infix and Unary Special Forms ####</span>
<span class="token comment">##########################################</span>

<span class="token comment"># Special forms are inherent to the grammar of LoT, but get converted to Calls</span>
<span class="token comment"># to primitives</span>

<span class="token comment"># &quot;Standard&quot; math functions are considered special forms</span>
<span class="token number">80</span><span class="token operator">+</span><span class="token number">90</span>    <span class="token comment"># ~&gt; __add(80, 90)</span>
<span class="token number">16</span><span class="token operator">-</span><span class="token number">10</span>    <span class="token comment"># ~&gt; __sub(16, 10)</span>
<span class="token number">31</span><span class="token operator">*</span><span class="token number">40</span>    <span class="token comment"># ~&gt; __mul(31, 40)</span>
<span class="token number">48</span><span class="token operator">/</span><span class="token number">64</span>    <span class="token comment"># ~&gt; __div(48, 64)</span>
<span class="token operator">-</span><span class="token number">7</span>       <span class="token comment"># ~&gt; __neg(7)</span>
<span class="token function">mod</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># ~&gt; mod(9, 5)</span>
<span class="token number">10</span><span class="token operator">&gt;</span><span class="token number">20</span>    <span class="token comment"># ~&gt; __gt(10, 20)</span>
<span class="token number">10</span><span class="token operator">&lt;</span><span class="token number">20</span>    <span class="token comment"># ~&gt; __lt(10, 20)</span>
<span class="token number">10</span><span class="token operator">&gt;=</span><span class="token number">20</span>   <span class="token comment"># ~&gt; __geq(10, 20)</span>
<span class="token number">10</span><span class="token operator">&lt;=</span><span class="token number">20</span>   <span class="token comment"># ~&gt; __leq(10, 20)</span>
<span class="token number">10</span><span class="token operator">==</span><span class="token number">20</span>   <span class="token comment"># ~&gt; __eq(10, 20)</span>
<span class="token number">10</span>!<span class="token operator">=</span><span class="token number">20</span>   <span class="token comment"># ~&gt; __neq(10, 20)</span>

<span class="token comment"># As well as boolean logic</span>
<span class="token keyword keyword-true">true</span> <span class="token keyword keyword-and">and</span> <span class="token keyword keyword-false">false</span> <span class="token comment"># ~&gt; __and(true, false)</span>
<span class="token keyword keyword-true">true</span> <span class="token keyword keyword-or">or</span> <span class="token keyword keyword-false">false</span>  <span class="token comment"># ~&gt; __or(true, false)</span>
<span class="token keyword keyword-true">true</span> <span class="token operator">==</span> <span class="token keyword keyword-false">false</span>  <span class="token comment"># ~&gt; __eq(true, false)</span>
<span class="token keyword keyword-true">true</span> !<span class="token operator">=</span> <span class="token keyword keyword-false">false</span>  <span class="token comment"># ~&gt; __neq(true, false)</span>

<span class="token comment"># You can check the truthy-ness of a value by using &apos;Boolean&apos;. As a general rule,</span>
<span class="token comment"># the only things that are false are 0, nil, and false itself.</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token comment"># true</span>

<span class="token comment">#######################################</span>
<span class="token comment">#### 3. Control Flow Special Forms ####</span>
<span class="token comment">#######################################</span>

<span class="token comment"># A do expression will execute a series of expressions, in order, and return the</span>
<span class="token comment"># last expression evaluated</span>
<span class="token keyword">let </span>cond <span class="token operator">=</span> <span class="token keyword keyword-do">do</span> <span class="token number">100</span> <span class="token number">200</span> <span class="token number">300</span> <span class="token number">400</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-end">end</span> <span class="token comment"># cond &lt;- true</span>

<span class="token comment"># An if expression works how you would think. Each then-end, then-elif, </span>
<span class="token comment"># then-else, and then-end pair works like a do block </span>
<span class="token keyword keyword-if">if</span> cond <span class="token keyword keyword-then">then</span> 
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Yay!&quot;</span><span class="token punctuation">)</span> 
<span class="token keyword keyword-elif">elif</span> !cond <span class="token keyword keyword-then">then</span> 
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Yoo!&quot;</span><span class="token punctuation">)</span>
<span class="token keyword keyword-else">else</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Huh?!&quot;</span><span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>

<span class="token keyword keyword-if">if</span> !cond <span class="token keyword keyword-then">then</span> <span class="token string">&quot;Something&quot;</span> <span class="token keyword keyword-end">end</span> <span class="token comment"># -&gt; nil</span>

<span class="token comment"># A while expression will execute do block while the condition is true</span>
<span class="token keyword">let </span>bottles <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword keyword-while">while</span> bottles <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword keyword-do">do</span>
  <span class="token keyword">let </span>plural <span class="token operator">=</span> <span class="token keyword keyword-if">if</span> bottles <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword keyword-then">then</span> <span class="token string">&quot;bottle&quot;</span> <span class="token keyword keyword-else">else</span> <span class="token string">&quot;bottles&quot;</span> <span class="token keyword keyword-end">end</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;* &quot;</span><span class="token punctuation">,</span> bottles<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> plural<span class="token punctuation">,</span> <span class="token string">&quot; of milk on the wall.&quot;</span><span class="token punctuation">)</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span> bottles<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> plural<span class="token punctuation">,</span> <span class="token string">&quot; of milk!.&quot;</span><span class="token punctuation">)</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  Take one down, pass it around!&quot;</span><span class="token punctuation">)</span>
  bottles <span class="token operator">=</span> bottles <span class="token operator">-</span> <span class="token number">1</span>
  plural <span class="token operator">=</span> <span class="token keyword keyword-if">if</span> bottles <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword keyword-then">then</span> <span class="token string">&quot;bottle&quot;</span> <span class="token keyword keyword-else">else</span> <span class="token string">&quot;bottles&quot;</span> <span class="token keyword keyword-end">end</span>
  <span class="token keyword">let </span>count <span class="token operator">=</span> <span class="token keyword keyword-if">if</span> bottles <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword keyword-then">then</span> <span class="token string">&quot;No more&quot;</span> <span class="token keyword keyword-else">else</span> bottles <span class="token keyword keyword-end">end</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span> count<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> plural<span class="token punctuation">,</span> <span class="token string">&quot; of milk on the wall!&quot;</span><span class="token punctuation">)</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword keyword-end">end</span>

<span class="token comment"># Fun expressions return a user-defined procedure. The list following &apos;fun&apos;</span>
<span class="token comment"># must contain only symbols. After the list, a single expression follows.</span>
<span class="token keyword">let </span>double <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>number<span class="token punctuation">]</span> <span class="token number">2</span><span class="token operator">*</span>number
<span class="token function">println</span><span class="token punctuation">(</span><span class="token function">double</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># In order to execute multiple statements within a procedure, a do block often</span>
<span class="token comment"># follows. Additionally, since functions are just another data type, you can </span>
<span class="token comment"># declare closures inside.</span>
<span class="token keyword">let </span>fib <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
  <span class="token keyword">let </span>fib_help <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> n<span class="token punctuation">]</span>
    <span class="token keyword keyword-if">if</span> n <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword keyword-then">then</span> <span class="token function">fib_help</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token operator">+</span>b<span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-else">else</span> a <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-return">return</span> <span class="token function">fib_help</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>

<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;fib(20) is &quot;</span><span class="token punctuation">,</span> <span class="token function">fib</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># -&gt; 6765</span>

<span class="token comment">###################################</span>
<span class="token comment">#### 4. Things and Meta-Things ####</span>
<span class="token comment">###################################</span>

<span class="token comment"># The namesake of LoT is the Thing. A thing can be thought of as a map of keys </span>
<span class="token comment"># to values. There are a couple of different ways to associate the keys with</span>
<span class="token comment"># values</span>
<span class="token keyword">let </span>thing1  <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment"># Thing declaration</span>
thing1<span class="token punctuation">.</span>x    <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment"># Dot notation. The symbol gets transformed into a string</span>
thing1<span class="token punctuation">[</span><span class="token string">&quot;x&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment"># Bracket notation. Functionally the same as above.</span>
<span class="token keyword">let </span>thing2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span>apples <span class="token operator">=</span> <span class="token string">&quot;yummy&quot;</span><span class="token punctuation">,</span>   <span class="token comment"># You can initialize Things inside the curly braces </span>
  <span class="token punctuation">.</span>cherries <span class="token operator">=</span> <span class="token string">&quot;yummy&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&quot;pears&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;gross&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment"># Every value not supplied a key will automatically get a number key, starting</span>
<span class="token comment"># at 0 and increasing from there</span>
<span class="token keyword">let </span>thing3 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;in&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;order&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;thing&quot;</span> <span class="token punctuation">}</span>
<span class="token function">println</span><span class="token punctuation">(</span>thing3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;in&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Declaring a procedure on an object is easy</span>
thing2<span class="token punctuation">.</span>spawn_apple <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token string">&quot;apple&quot;</span>
<span class="token comment"># Calling is easy as well</span>
<span class="token function">println</span><span class="token punctuation">(</span>thing2<span class="token punctuation">.</span><span class="token function">spawn_apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Since you can pass anything to a procedure, you can even pass the Thing itself</span>
thing2<span class="token punctuation">.</span>is_yummy <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> food<span class="token punctuation">]</span> self<span class="token punctuation">[</span>food<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;yummy&quot;</span>
thing2<span class="token punctuation">.</span><span class="token function">is_yummy</span><span class="token punctuation">(</span>thing2<span class="token punctuation">,</span> <span class="token string">&quot;pears&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># This leads to a form of OOP. Since this is such a common idiom, there is a</span>
<span class="token comment"># shorthand notation. Everything to the left of &apos;:&apos; is evaluated. Then the </span>
<span class="token comment"># procedure is obtained from it and called, with the Thing passed as the first</span>
<span class="token comment"># parameter.</span>
thing2<span class="token punctuation">:</span><span class="token function">is_yummy</span><span class="token punctuation">(</span><span class="token string">&quot;pears&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Things also have meta-things. You can set a Meta-Thing like so:</span>
<span class="token keyword">let </span>superthing <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">let </span>subthing <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">&quot;A&quot;</span> <span class="token punctuation">}</span>   <span class="token comment"># These two lines could also be shortened to just</span>
<span class="token function">setmeta</span><span class="token punctuation">(</span>subthing<span class="token punctuation">,</span> superthing<span class="token punctuation">)</span> <span class="token comment"># &apos;<span class="token keyword">let </span>subthing = setmeta({.a = &quot;A&quot; }, superthing)&apos;</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getmeta</span><span class="token punctuation">(</span>subthing<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># Prints &apos;{ }&apos;</span>

<span class="token comment"># If you access a key on a Thing that does not exist, it will look up &apos;__get&apos; on</span>
<span class="token comment"># on the metatable. If it does not exist, it returns nil. If it is a Thing, it</span>
<span class="token comment"># will look up the property on that thing. If it is a procedure, it will call</span>
<span class="token comment"># it with the arguments the original thing and the key you are looking up</span>
superthing<span class="token punctuation">.</span>__get <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>thing<span class="token punctuation">,</span> key<span class="token punctuation">]</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;No key &apos;&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token string">&quot;&apos; in &quot;</span><span class="token punctuation">,</span> thing<span class="token punctuation">)</span>
subthing<span class="token punctuation">.</span>a
subthing<span class="token punctuation">.</span>invalid <span class="token comment"># Prints &quot;No key &apos;invalid&apos; in { }&quot;</span>

<span class="token comment"># This leads to some interesting prototypal inheritance</span>
<span class="token keyword">let </span>Account <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span>__get <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>thing<span class="token punctuation">,</span> key<span class="token punctuation">]</span> Account<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>new <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> balance<span class="token punctuation">]</span>
    <span class="token function">setmeta</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token punctuation">.</span>balance <span class="token operator">=</span> balance <span class="token punctuation">}</span><span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>withdraw <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> amount<span class="token punctuation">]</span>
    self<span class="token punctuation">.</span>balance <span class="token operator">=</span> self<span class="token punctuation">.</span>balance <span class="token operator">-</span> amount<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">let </span>acc <span class="token operator">=</span> Account<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
acc<span class="token punctuation">:</span><span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span>acc<span class="token punctuation">.</span>balance<span class="token punctuation">)</span>

<span class="token comment"># Here is another example</span>
<span class="token keyword">let </span>Dog <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Dog<span class="token punctuation">.</span>new <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
  <span class="token keyword">let </span>o <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>sound <span class="token operator">=</span> <span class="token string">&quot;Woof!&quot;</span> <span class="token punctuation">}</span>
  self<span class="token punctuation">.</span>__get <span class="token operator">=</span> self
  <span class="token function">setmeta</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> self<span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>
Dog<span class="token punctuation">.</span>speak <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> <span class="token function">println</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>sound<span class="token punctuation">)</span>

<span class="token keyword">let </span>doggo <span class="token operator">=</span> Dog<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
doggo<span class="token punctuation">:</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Prints &apos;Woof!&apos;</span>

<span class="token keyword">let </span>AnnoyingDog <span class="token operator">=</span> Dog<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
AnnoyingDog<span class="token punctuation">.</span>speak <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;WOOF WOOF WOOF!&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">let </span>fido <span class="token operator">=</span> AnnoyingDog<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fido<span class="token punctuation">:</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># Prints &apos;WOOF WOOF WOOF!&apos;</span>
</pre><h2 class="mume-header" id="3-expression-types">3. Expression Types</h2>

<p>Everything in LoT is an expression. This means that everything that gets parsed by the language evaluates to something else in the language. Most of the time, it&apos;s a self-circular evaluation - meaning the expression evaluates to itself. Other times, like for Calls and Symbols, something special happens.</p>
<p>There are 10 data types in LoT. They can be divided into 3 distinct categories:</p>
<ul>
<li>Trivial (Number, String, Boolean)</li>
<li>Semi-trivial (Nil, Symbol)</li>
<li>Non-trivial (List, Thing, Call, Primitive, Procedure)</li>
</ul>
<h3 class="mume-header" id="31-trivial-types-number-string-boolean">3.1 Trivial Types (Number, String, Boolean)</h3>

<p>The 3 trivial data types are Number, String, and Boolean. These data types should be fairly easy to understand.</p>
<p><strong>Number</strong>: Numbers are implemented as IEEE double precision floating point numbers.<br>
<strong>String</strong>: Implemented as a standard C-style string.<br>
<strong>Boolean</strong>: Implemented as a standard C boolean.</p>
<p>Each of these expression types are compared by <em>value</em>. So for example.</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/3_1_compare.lot</span>
<span class="token comment"># The following program prints nothing but &quot;passed&quot;</span>
<span class="token keyword">let </span>assert <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>expr<span class="token punctuation">]</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword keyword-if">if</span> expr <span class="token keyword keyword-then">then</span> <span class="token string">&quot;passed&quot;</span> <span class="token keyword keyword-else">else</span> <span class="token string">&quot;failed&quot;</span> <span class="token keyword keyword-end">end</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Testing equality&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token number">3</span> !<span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword keyword-true">true</span> <span class="token operator">==</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token keyword keyword-true">true</span> !<span class="token operator">=</span> <span class="token keyword keyword-false">false</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token string">&quot;Suprising?&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;Suprising?&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token string">&quot;Suprising?&quot;</span> !<span class="token operator">=</span> <span class="token string">&quot;Not really.&quot;</span><span class="token punctuation">)</span>
</pre><p>You can also easily convert between these types.</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/3_1_convert.lot</span>
<span class="token keyword">let </span>assert <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>expr<span class="token punctuation">]</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword keyword-if">if</span> expr <span class="token keyword keyword-then">then</span> <span class="token string">&quot;passed&quot;</span> <span class="token keyword keyword-else">else</span> <span class="token string">&quot;failed&quot;</span> <span class="token keyword keyword-end">end</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Testing conversions&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token string">&quot;1234&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1234</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword keyword-true">true</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span><span class="token keyword keyword-false">false</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token number">10101</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;10101&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword keyword-true">true</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token keyword keyword-false">false</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-false">false</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token string">&quot;Apples&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="32-semi-trivial-types-nil-symbol">3.2 Semi-trivial Types (Nil, Symbol)</h3>

<p>The 2 Semi-trivial data types are Nil and Symbol.</p>
<p><strong>Nil</strong>: Internally, nil is represented by a singular object. Any internal object pointer that points to nil is considered nil.</p>
<p><strong>Symbol</strong>: Internally, Symbols are represented nearly identically to strings. The only difference is that when a symbol is created, it gets &quot;interned&quot; into a global object map. Then their pointers are compared, rather than the object itself. Additionally, there is no way for a user to store a symbol in a variable. Symbols can only be the variables themselves.</p>
<h3 class="mume-header" id="33-non-trivial-types-list-thing-call-primitive-procedure">3.3 Non-trivial Types (List, Thing, Call, Primitive, Procedure)</h3>

<p>There are 5 non-trivial data types. These types are compared via reference, and usually cannot be compared using standard operators.</p>
<p><strong>List</strong>: Used internally. While you can declare lists using <code>[ stuff, stuff, ... ]</code>, <em>it is highly recommended that you do not use them</em>. Lists are immutable, and you cannot directly access the elements. The are used primarily for passing arguments to functions internally.</p>
<p><strong>Thing</strong>: Things can be thought of as simple key value containers. They associate expression to other expressions. Additionally, Things can have associated Meta-Things. If a key is not present, it</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/3_3_things.lot</span>
<span class="token keyword">let </span>assert <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>expr<span class="token punctuation">]</span> <span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword keyword-if">if</span> expr <span class="token keyword keyword-then">then</span> <span class="token string">&quot;passed&quot;</span> <span class="token keyword keyword-else">else</span> <span class="token string">&quot;failed&quot;</span> <span class="token keyword keyword-end">end</span><span class="token punctuation">)</span>

<span class="token keyword">let </span>a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
a<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span>         <span class="token comment"># Access using dot notation</span>
a<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token string">&quot;whatever&quot;</span> <span class="token comment"># Symbols get converted to strings internally</span>
a<span class="token punctuation">[</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;huh?&quot;</span>  <span class="token comment"># Overwrite the previous statement</span>
a<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-true">true</span>
a<span class="token punctuation">[</span><span class="token keyword keyword-true">true</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-false">false</span>
<span class="token function">assert</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>b <span class="token operator">==</span> <span class="token string">&quot;huh?&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword keyword-true">true</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span><span class="token keyword keyword-true">true</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword keyword-false">false</span><span class="token punctuation">)</span>
a<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token keyword keyword-nil">nil</span> <span class="token comment"># Remove key from Thing</span>

<span class="token keyword">let </span>b <span class="token operator">=</span> <span class="token punctuation">{</span> 
  <span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Hola Mundo!&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Hallo Welt!&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token keyword keyword-true">true</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> x<span class="token operator">*</span>x <span class="token comment"># Values can also be functions</span>
<span class="token punctuation">}</span>
<span class="token function">assert</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>a <span class="token operator">==</span> <span class="token string">&quot;Hello world!&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>b <span class="token operator">==</span> <span class="token string">&quot;Hola Mundo!&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;Hallo Welt!&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span><span class="token keyword keyword-true">true</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment"># If a key is not supplied, it will get the next available integer key, starting</span>
<span class="token comment"># from 0</span>
<span class="token keyword">let </span>c <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;apples&quot;</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token keyword keyword-false">false</span> <span class="token punctuation">}</span> 
<span class="token function">assert</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;apples&quot;</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">123</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword keyword-false">false</span><span class="token punctuation">)</span>

<span class="token comment"># If a property does not exist on a Thing, it will look up &apos;__get&apos; on its</span>
<span class="token comment"># associated Meta-Thing</span>
<span class="token keyword">let </span>d <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>on_orig <span class="token operator">=</span> <span class="token string">&quot;other&quot;</span> <span class="token punctuation">}</span>
<span class="token keyword">let </span>e <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>on_meta <span class="token operator">=</span> <span class="token string">&quot;thing&quot;</span> <span class="token punctuation">}</span>
<span class="token function">setmeta</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span><span class="token function">getmeta</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span> <span class="token operator">==</span> e<span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>on_meta <span class="token operator">==</span> <span class="token keyword keyword-nil">nil</span><span class="token punctuation">)</span> <span class="token comment"># If it does not exist, it will return nil</span>

<span class="token comment"># If it is a table, it will look up the key on that table</span>
e<span class="token punctuation">.</span>__get <span class="token operator">=</span> e 
<span class="token function">assert</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>on_meta <span class="token operator">==</span> <span class="token string">&quot;thing&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># If it is a procedure, it will call the procedure with original Thing and key</span>
e<span class="token punctuation">.</span>__get <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>thing<span class="token punctuation">,</span> key<span class="token punctuation">]</span> thing<span class="token punctuation">.</span>on_orig
<span class="token function">assert</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>on_meta <span class="token operator">==</span> <span class="token string">&quot;other&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Otherwise, it will return nil</span>
e<span class="token punctuation">.</span>__get <span class="token operator">=</span> <span class="token string">&quot;nope&quot;</span>
<span class="token function">assert</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>on_meta <span class="token operator">==</span> <span class="token keyword keyword-nil">nil</span><span class="token punctuation">)</span>

<span class="token comment"># Often, you may want to write a procedure that modifies things.</span>
<span class="token comment"># You may be tempted to write something like this:</span>
<span class="token keyword">let </span>f <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>money <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token keyword">let </span>add_money <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>thing<span class="token punctuation">,</span> amount<span class="token punctuation">]</span> thing<span class="token punctuation">.</span>money <span class="token operator">=</span> thing<span class="token punctuation">.</span>money <span class="token operator">+</span> amount
<span class="token function">add_money</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>money <span class="token operator">==</span> <span class="token number">123</span><span class="token punctuation">)</span>

<span class="token comment"># This is a valid approach, very C-style. If you want to associate the functions</span>
<span class="token comment"># with the Things, you may be tempted to put the procedure *inside* the thing.</span>
<span class="token keyword">let </span>g <span class="token operator">=</span> <span class="token punctuation">{</span> 
  <span class="token punctuation">.</span>money <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> 
  <span class="token punctuation">.</span>add_money <span class="token operator">=</span>  <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> amt<span class="token punctuation">]</span> self<span class="token punctuation">.</span>money <span class="token operator">=</span> self<span class="token punctuation">.</span>money <span class="token operator">+</span> amt 
<span class="token punctuation">}</span>
g<span class="token punctuation">.</span><span class="token function">add_money</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> <span class="token number">31415</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>money <span class="token operator">==</span> <span class="token number">31415</span><span class="token punctuation">)</span>

<span class="token comment"># This is basically object-oriented programming via prototypes. This is such a</span>
<span class="token comment"># common pattern that you can use a special colon syntax to accomplish the same</span>
<span class="token comment"># result</span>
g<span class="token punctuation">:</span><span class="token function">add_money</span><span class="token punctuation">(</span><span class="token number">51413</span><span class="token punctuation">)</span>
<span class="token function">assert</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>money <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token number">31415</span> <span class="token operator">+</span> <span class="token number">51413</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># It also can get somewhat confusing if you are not careful...</span>
<span class="token keyword">let </span>h <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>f <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> self<span class="token punctuation">.</span>a<span class="token punctuation">,</span>
  <span class="token punctuation">.</span>g <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> self<span class="token punctuation">:</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">assert</span><span class="token punctuation">(</span>h<span class="token punctuation">:</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span>
</pre><p>At the heart of LoT is a simple LISP-style EVAL APPLY loop. Most things simply evaluate to themselves. Symbols evaluate to whatever is stored in the current environment. However, Calls are a bit special.</p>
<p><strong>Call</strong>: A call consists of two things: an expression representing either the procedure or primitive to call, and a list of arguments. When evaluated, it will &quot;apply&quot; the arguments to the former expression.</p>
<p><strong>Procedure</strong>: A procedure evaluates all of its arguments, creates a new environment to execute in, sets each of its parameters to the evaluated arguments, and evaluates the body statements it has one by one. It also listens for a <code>return expr</code> expression, and will return that expression instead if encountered.</p>
<p><strong>Primitive</strong>:</p>
<h2 class="mume-header" id="4-primitives">4. Primitives</h2>

<p>The majority of the grammar is syntactic sugar to convert specific structures into these primitives. If you wanted to, you could write any LoT program using just functional notation - though I would heavily advise against this.</p>
<p>I will use the following syntax to describe the primitives:</p>
<ul>
<li><code>~&gt;</code> means <code>transforms into</code>, meaning the parser will change it from the left to the right. Not every primitive needs transforming.</li>
<li><code>-&gt;</code> means <code>returns</code></li>
<li><code>...</code> means the primitive supports an arbitrary number of arguments</li>
</ul>
<h3 class="mume-header" id="41-io">4.1 IO</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token function">print</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword keyword-nil">nil</span>
  expr <span class="token punctuation">::</span> The expressions to print

<span class="token function">println</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token keyword keyword-nil">nil</span>
  expr <span class="token punctuation">::</span> The expressions to print<span class="token punctuation">,</span> <span class="token keyword keyword-then">then</span> a single newline

<span class="token function">input</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> str
  expr <span class="token punctuation">::</span> The expressions to print
  str  <span class="token punctuation">::</span> The resulting string read from standard <span class="token keyword keyword-in">in</span>

<span class="token function">gettime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  num <span class="token punctuation">::</span> The current Unix time
</pre><h3 class="mume-header" id="42-types">4.2 Types</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token function">Boolean</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  expr <span class="token punctuation">::</span> The expression to convert to a Boolean
  bool <span class="token punctuation">::</span> The truthiness of expr

<span class="token function">Number</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  expr <span class="token punctuation">::</span> The expression to convert to a Number
  res  <span class="token punctuation">::</span> The number <span class="token keyword keyword-if">if</span> successful<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-nil">nil</span>

<span class="token function">String</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> str
  expr <span class="token punctuation">::</span> The expressions to convert to string<span class="token punctuation">.</span>
  str  <span class="token punctuation">::</span> The concatenated resultant <span class="token function">string</span>

<span class="token punctuation">{</span> fieldlist? <span class="token punctuation">}</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__thing</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> thing
  key   <span class="token punctuation">::</span> The key of the field
  value <span class="token punctuation">::</span> The value to set<span class="token punctuation">.</span> NOTE<span class="token punctuation">:</span> key <span class="token keyword keyword-and">and</span> values must come <span class="token keyword keyword-in">in</span> pairs
  thing <span class="token punctuation">::</span> The resultant thing

<span class="token punctuation">[</span> expr<span class="token punctuation">,</span> <span class="token punctuation">...</span> <span class="token punctuation">]</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__list</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> list
  expr <span class="token punctuation">::</span> The list of expressions to evaluate
  list <span class="token punctuation">::</span> The list of evaluated expressions

<span class="token function">type</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> str
  expr <span class="token punctuation">::</span> The expression to get the type of
  str  <span class="token punctuation">::</span> <span class="token string">&quot;Symbol&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;String&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Number&quot;</span><span class="token punctuation">,</span> etc<span class="token punctuation">...</span>
</pre><h3 class="mume-header" id="43-arithmetic">4.3 Arithmetic</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua">x <span class="token operator">+</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  x   <span class="token punctuation">::</span> The first number
  y   <span class="token punctuation">::</span> The second number
  num <span class="token punctuation">::</span> The result of x <span class="token operator">+</span> y

x <span class="token operator">-</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__sub</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  x   <span class="token punctuation">::</span> The first number
  y   <span class="token punctuation">::</span> The second number
  num <span class="token punctuation">::</span> The result of x <span class="token operator">-</span> y

x <span class="token operator">+</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__mul</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  x   <span class="token punctuation">::</span> The first number
  y   <span class="token punctuation">::</span> The second number
  num <span class="token punctuation">::</span> The result of x <span class="token operator">*</span> y

x <span class="token operator">+</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__div</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  x   <span class="token punctuation">::</span> The first number
  y   <span class="token punctuation">::</span> The second number
  num <span class="token punctuation">::</span> The result of x <span class="token operator">/</span> y

<span class="token function">mod</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  x   <span class="token punctuation">::</span> The first number
  y   <span class="token punctuation">::</span> The second number
  num <span class="token punctuation">::</span> The result of x modulo y

<span class="token operator">-</span>x <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__neg</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> num
  x   <span class="token punctuation">::</span> The number to negate
  num <span class="token punctuation">::</span> The negation of x
</pre><h3 class="mume-header" id="44-comparison">4.4 Comparison</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua">x <span class="token operator">==</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__eq</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> Returns <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> the objects are <span class="token function">equal</span> <span class="token punctuation">(</span>by value <span class="token keyword keyword-for">for</span> trivial<span class="token punctuation">)</span><span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span><span class="token punctuation">.</span>

x !<span class="token operator">=</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__neq</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> Returns <span class="token keyword keyword-false">false</span> <span class="token keyword keyword-if">if</span> the objects are <span class="token function">equal</span> <span class="token punctuation">(</span>by value <span class="token keyword keyword-for">for</span> trivial<span class="token punctuation">)</span><span class="token punctuation">,</span> otherwise <span class="token keyword keyword-true">true</span><span class="token punctuation">.</span>
</pre><h3 class="mume-header" id="45-logic">4.5 Logic</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua">!x <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__not</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The expression to evaluate
  bool <span class="token punctuation">::</span> The opposite truthy value of x

x <span class="token keyword keyword-and">and</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__and</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> x <span class="token keyword keyword-and">and</span> y are truthy<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span>

x <span class="token keyword keyword-or">or</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__or</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> x <span class="token keyword keyword-or">or</span> y are truthy<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span>
</pre><h3 class="mume-header" id="46-ordering">4.6 Ordering</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua">x <span class="token operator">&gt;</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__gt</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> x <span class="token operator">&gt;</span> y<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span>

x <span class="token operator">&gt;=</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__geq</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> x <span class="token operator">&gt;=</span> y<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span>

x <span class="token operator">&lt;</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__lt</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> x <span class="token operator">&lt;</span> y<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span>

x <span class="token operator">&lt;=</span> y <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__leq</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> bool
  x    <span class="token punctuation">::</span> The first expression
  y    <span class="token punctuation">::</span> The second expression
  bool <span class="token punctuation">::</span> <span class="token keyword keyword-true">true</span> <span class="token keyword keyword-if">if</span> x <span class="token operator">&lt;=</span> y<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-false">false</span>
</pre><h3 class="mume-header" id="47-control-flow">4.7 Control Flow</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token keyword keyword-do">do</span> expr <span class="token punctuation">...</span> <span class="token keyword keyword-end">end</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__do</span><span class="token punctuation">(</span>expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  expr <span class="token punctuation">::</span> The expressions to evaluate<span class="token punctuation">,</span> <span class="token keyword keyword-in">in</span> order
  res  <span class="token punctuation">::</span> The last expression<span class="token punctuation">,</span> evaluated

<span class="token keyword keyword-if">if</span> a <span class="token keyword keyword-then">then</span> <span class="token function">e</span> <span class="token punctuation">(</span> <span class="token keyword keyword-elif">elif</span> b <span class="token keyword keyword-then">then</span> e <span class="token punctuation">)</span><span class="token operator">*</span> <span class="token punctuation">(</span> <span class="token keyword keyword-else">else</span> e <span class="token punctuation">)</span>? <span class="token keyword keyword-end">end</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__if</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> e<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">::</span> The conditions
  e       <span class="token punctuation">::</span> The expressions to evaluate
  res     <span class="token punctuation">::</span> The last expression evaluated

<span class="token keyword keyword-while">while</span> cond <span class="token keyword keyword-do">do</span> expr <span class="token punctuation">...</span> <span class="token keyword keyword-end">end</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token keyword keyword-while">while</span><span class="token punctuation">(</span>cond<span class="token punctuation">,</span> expr<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  cond <span class="token punctuation">::</span> The condition of the loop
  expr <span class="token punctuation">::</span> The expressions to evaluate
  res  <span class="token punctuation">::</span> The last expression<span class="token punctuation">,</span> evaluated<span class="token punctuation">.</span> If none<span class="token punctuation">,</span> <span class="token keyword keyword-then">then</span> <span class="token keyword keyword-nil">nil</span>
</pre><h3 class="mume-header" id="48-procedures">4.8 Procedures</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token keyword">fun </span><span class="token punctuation">[</span>s<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">]</span> expr <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__fun</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  s    <span class="token punctuation">::</span> The symbols <span class="token keyword keyword-for">for</span> the parameters
  list <span class="token punctuation">::</span> The list of parameters
  expr <span class="token punctuation">::</span> The expression representing the procedure
  res  <span class="token punctuation">::</span> The result of the procedure 

<span class="token keyword keyword-return">return</span> expr <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__return</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> expr
  expr <span class="token punctuation">::</span> The expression to <span class="token keyword keyword-return">return</span>
</pre><h3 class="mume-header" id="49-variables">4.9 Variables</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token keyword">let </span>sym <span class="token operator">=</span> expr <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__let</span><span class="token punctuation">(</span>sym<span class="token punctuation">,</span> expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> expr
  sym  <span class="token punctuation">::</span> The symbol to set
  expr <span class="token punctuation">::</span> The expr to set the symbol to

sym <span class="token operator">=</span> expr <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__assign</span><span class="token punctuation">(</span>sym<span class="token punctuation">,</span> expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> expr
  sym  <span class="token punctuation">::</span> The symbol to set
  expr <span class="token punctuation">::</span> The expr to set the symbol to
</pre><h3 class="mume-header" id="410-thing-modification">4.10 Thing Modification</h3>

<pre data-role="codeBlock" data-info="lua" class="language-lua">thing<span class="token punctuation">.</span>sym   <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__get</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> sym<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
thing<span class="token punctuation">[</span>expr<span class="token punctuation">]</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__get</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> expr<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  thing <span class="token punctuation">::</span> The thing to get values from
  sym   <span class="token punctuation">::</span> The symbol to use as a key
  expr  <span class="token punctuation">::</span> The expression to use as a key
  res   <span class="token punctuation">::</span> The value <span class="token keyword keyword-if">if</span> found when accessing<span class="token punctuation">,</span> otherwise <span class="token keyword keyword-nil">nil</span>

thing<span class="token punctuation">.</span>sym   <span class="token operator">=</span> val <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__set</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> val
thing<span class="token punctuation">[</span>expr<span class="token punctuation">]</span> <span class="token operator">=</span> val <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__set</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> expr<span class="token punctuation">,</span> val<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> val
  thing <span class="token punctuation">::</span> The thing to get values from
  sym   <span class="token punctuation">::</span> The symbol to use as a key
  expr  <span class="token punctuation">::</span> The expression to use as a key
  val   <span class="token punctuation">::</span> The value to set

thing<span class="token punctuation">:</span><span class="token function">proc</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> <span class="token punctuation">...</span><span class="token punctuation">)</span> <span class="token operator">~</span><span class="token operator">&gt;</span> <span class="token function">__selfcall</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> proc<span class="token punctuation">,</span> args<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> res
  thing <span class="token punctuation">::</span> The thing to access
  proc  <span class="token punctuation">::</span> The procedure to call
  args  <span class="token punctuation">::</span> The argument to the procedure
  res   <span class="token punctuation">::</span> The result of the procedure
  
<span class="token function">getmeta</span><span class="token punctuation">(</span>thing<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> meta
  thing <span class="token punctuation">::</span> The thing to access
  meta  <span class="token punctuation">::</span> The Meta<span class="token operator">-</span>Thing of thing <span class="token keyword keyword-if">if</span> exists<span class="token punctuation">,</span> <span class="token keyword keyword-nil">nil</span> otherwise

<span class="token function">setmeta</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> meta<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> thing
  thing <span class="token punctuation">::</span> The thing to set the Meta<span class="token operator">-</span>Thing <span class="token keyword keyword-for">for</span>
  meta  <span class="token punctuation">::</span> The metathing itself
</pre><h2 class="mume-header" id="5-examples">5. Examples</h2>

<h3 class="mume-header" id="51-bottles-of-milk">5.1 Bottles of Milk</h3>

<p>Here&apos;s a classic program, bottles of milk!</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/5_1_bottles_of_milk.lot</span>
<span class="token keyword">let </span>bottles <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">&quot;How many bottles of milk are on the wall? &quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Demonstration of short-circuit logic evaulation</span>
<span class="token keyword keyword-while">while</span> <span class="token punctuation">(</span>bottles <span class="token operator">==</span> <span class="token keyword keyword-nil">nil</span><span class="token punctuation">)</span> <span class="token keyword keyword-or">or</span> <span class="token punctuation">(</span>bottles <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-or">or</span> <span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>bottles<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> !<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword keyword-do">do</span>
  bottles <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">&quot;Please enter a positive number.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>

<span class="token keyword">let </span>plural <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword keyword-if">if</span> bottles <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword keyword-then">then</span> <span class="token string">&quot;bottle&quot;</span> <span class="token keyword keyword-else">else</span> <span class="token string">&quot;bottles&quot;</span> <span class="token keyword keyword-end">end</span>
<span class="token keyword">let </span>count  <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword keyword-if">if</span> bottles <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword keyword-then">then</span> <span class="token string">&quot;No more&quot;</span> <span class="token keyword keyword-else">else</span> bottles <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-while">while</span> bottles <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token keyword keyword-do">do</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;* &quot;</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token function">plural</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot; of milk on the wall,&quot;</span><span class="token punctuation">)</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token function">plural</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot; of milk!&quot;</span><span class="token punctuation">)</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  Take one down, pass it around!&quot;</span><span class="token punctuation">)</span>
  bottles <span class="token operator">=</span> bottles <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;  &quot;</span><span class="token punctuation">,</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">,</span> <span class="token function">plural</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot; of milk on the wall!\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>
</pre><h3 class="mume-header" id="52-higher-lower-guessing-game">5.2 Higher-Lower Guessing Game</h3>

<p>Here&apos;s an example of the classic &quot;higher or lower&quot; guessing game</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/5_2_hi_lo.lot</span>
<span class="token keyword">let </span>make_generator <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>a<span class="token punctuation">,</span> c<span class="token punctuation">,</span> m<span class="token punctuation">]</span>
  <span class="token keyword keyword-return">return</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token function">gettime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>rnd <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span>
      self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token function">mod</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>state <span class="token operator">+</span> c<span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span>seed <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> new_seed<span class="token punctuation">]</span>
      self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token function">mod</span><span class="token punctuation">(</span>new_seed<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>

rng <span class="token operator">=</span> <span class="token function">make_generator</span><span class="token punctuation">(</span><span class="token number">1103515245</span><span class="token punctuation">,</span> <span class="token number">12345</span><span class="token punctuation">,</span> <span class="token number">2147483648</span><span class="token punctuation">)</span>

<span class="token keyword">let </span>game <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>number<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;I am thinking of a number between 0 and 100. Try and guess it!&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword">let </span>guess <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
  <span class="token keyword keyword-while">while</span> guess !<span class="token operator">=</span> number <span class="token keyword keyword-do">do</span>
    guess <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-if">if</span> guess <span class="token operator">==</span> <span class="token keyword keyword-nil">nil</span> <span class="token keyword keyword-then">then</span>
      <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Please enter a number!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-elif">elif</span> guess <span class="token operator">&gt;</span> number <span class="token keyword keyword-then">then</span>
      <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Lower!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-elif">elif</span> guess <span class="token operator">&lt;</span> number <span class="token keyword keyword-then">then</span>
      <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Higher!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-else">else</span>
      <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;You got it!&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-end">end</span>
<span class="token keyword keyword-end">end</span>

<span class="token function">game</span><span class="token punctuation">(</span><span class="token function">mod</span><span class="token punctuation">(</span>rng<span class="token punctuation">:</span><span class="token function">rnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="53-tail-call-optimization">5.3 Tail-call-optimization</h3>

<p>Here&apos;s an example of tail-call optimization</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/5_3_tail_call.lot</span>
<span class="token keyword">let </span>fact <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
  <span class="token keyword">let </span>fact_tail <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> acc<span class="token punctuation">]</span>
    <span class="token keyword keyword-if">if</span> x <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword keyword-then">then</span> 
      acc
    <span class="token keyword keyword-else">else</span>
      <span class="token function">fact_tail</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> x<span class="token operator">*</span>acc<span class="token punctuation">)</span>
    <span class="token keyword keyword-end">end</span>
  <span class="token function">fact_tail</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>

<span class="token keyword">let </span>i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword keyword-while">while</span> i <span class="token operator">&lt;=</span> <span class="token number">10</span> <span class="token keyword keyword-do">do</span>
  <span class="token function">println</span><span class="token punctuation">(</span><span class="token function">fact</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
  i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword keyword-end">end</span>
</pre><h3 class="mume-header" id="54-vector">5.4 Vector</h3>

<p>Here&apos;s an implementation of a c++ style vector</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/5_4_vector.lot</span>
<span class="token keyword">let </span>Array <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">.</span>new <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
    <span class="token keyword">let </span>o <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">.</span>capacity <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span>
    self<span class="token punctuation">.</span>__get <span class="token operator">=</span> self
    <span class="token function">setmeta</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> self<span class="token punctuation">)</span>
  <span class="token keyword keyword-end">end</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>push_back <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> item<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
    self<span class="token punctuation">[</span>self<span class="token punctuation">.</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> item
    self<span class="token punctuation">.</span>size <span class="token operator">=</span> self<span class="token punctuation">.</span>size <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword keyword-if">if</span> self<span class="token punctuation">.</span>size <span class="token operator">&gt;</span> self<span class="token punctuation">.</span>capacity <span class="token keyword keyword-then">then</span> 
      self<span class="token punctuation">.</span>capacity <span class="token operator">=</span> self<span class="token punctuation">.</span>capacity <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token keyword keyword-end">end</span>
    <span class="token keyword keyword-return">return</span> item
  <span class="token keyword keyword-end">end</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>pop_back <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
    self<span class="token punctuation">.</span>size <span class="token operator">=</span> self<span class="token punctuation">.</span>size <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">let </span>ret <span class="token operator">=</span> self<span class="token punctuation">[</span>self<span class="token punctuation">.</span>size<span class="token punctuation">]</span>
    self<span class="token punctuation">[</span>self<span class="token punctuation">.</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword keyword-nil">nil</span>
    <span class="token keyword keyword-if">if</span> self<span class="token punctuation">.</span>size <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>capacity <span class="token keyword keyword-then">then</span>
      self<span class="token punctuation">.</span>capacity <span class="token operator">=</span> self<span class="token punctuation">.</span>capacity <span class="token operator">/</span> <span class="token number">2</span>
    <span class="token keyword keyword-end">end</span>
    <span class="token keyword keyword-return">return</span> ret
  <span class="token keyword keyword-end">end</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>at <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> idx<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
    <span class="token keyword keyword-if">if</span> <span class="token punctuation">(</span><span class="token function">type</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span> !<span class="token operator">=</span> <span class="token string">&quot;Number&quot;</span><span class="token punctuation">)</span> <span class="token keyword keyword-or">or</span> <span class="token punctuation">(</span>idx <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword keyword-or">or</span> <span class="token punctuation">(</span>idx <span class="token operator">&gt;=</span> self<span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token keyword keyword-then">then</span>
      <span class="token keyword keyword-nil">nil</span>
    <span class="token keyword keyword-else">else</span>
      self<span class="token punctuation">[</span>idx<span class="token punctuation">]</span>
    <span class="token keyword keyword-end">end</span>
  <span class="token keyword keyword-end">end</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span>print <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;[&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">let </span>i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword keyword-while">while</span> i <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>size <span class="token keyword keyword-do">do</span>
      <span class="token function">print</span><span class="token punctuation">(</span>self<span class="token punctuation">:</span><span class="token function">at</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword keyword-if">if</span> i <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>size <span class="token operator">-</span> <span class="token number">1</span> <span class="token keyword keyword-then">then</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;, &quot;</span><span class="token punctuation">)</span> <span class="token keyword keyword-end">end</span>
      i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword keyword-end">end</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;]&quot;</span><span class="token punctuation">)</span>
  <span class="token keyword keyword-end">end</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>


<span class="token keyword">let </span>arr <span class="token operator">=</span> Array<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

arr<span class="token punctuation">:</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">&quot;first&quot;</span><span class="token punctuation">)</span>  arr<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
arr<span class="token punctuation">:</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">&quot;second&quot;</span><span class="token punctuation">)</span> arr<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
arr<span class="token punctuation">:</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token string">&quot;third&quot;</span><span class="token punctuation">)</span>  arr<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">println</span><span class="token punctuation">(</span>arr<span class="token punctuation">:</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> arr<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span>arr<span class="token punctuation">:</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> arr<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">println</span><span class="token punctuation">(</span>arr<span class="token punctuation">:</span><span class="token function">pop_back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> arr<span class="token punctuation">:</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h3 class="mume-header" id="55-tree-traversal">5.5 Tree Traversal</h3>

<p>Here&apos;s an example of different types of tree traversals</p>
<pre data-role="codeBlock" data-info="lua" class="language-lua"><span class="token comment"># Original file: examples/5_5_dfs.lot</span>
<span class="token keyword">let </span>Node <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Node<span class="token punctuation">.</span>new <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> value<span class="token punctuation">,</span> left<span class="token punctuation">,</span> right<span class="token punctuation">]</span> <span class="token keyword keyword-do">do</span>
  <span class="token keyword">let </span>o <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">,</span> <span class="token punctuation">.</span>left <span class="token operator">=</span> left<span class="token punctuation">,</span> <span class="token punctuation">.</span>right <span class="token operator">=</span> right <span class="token punctuation">}</span>
  self<span class="token punctuation">.</span>__get <span class="token operator">=</span> self
  <span class="token function">setmeta</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> self<span class="token punctuation">)</span>
<span class="token keyword keyword-end">end</span>
Node<span class="token punctuation">.</span>leaf <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>self<span class="token punctuation">,</span> value<span class="token punctuation">]</span> self<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token keyword keyword-nil">nil</span><span class="token punctuation">,</span> <span class="token keyword keyword-nil">nil</span><span class="token punctuation">)</span>

<span class="token keyword">let </span>tree <span class="token operator">=</span> Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>
  <span class="token string">&quot;A&quot;</span><span class="token punctuation">,</span>
  Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>
    <span class="token string">&quot;B&quot;</span><span class="token punctuation">,</span> 
    Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;D&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;E&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;F&quot;</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;H&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">,</span> 
  Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span>
    <span class="token string">&quot;I&quot;</span><span class="token punctuation">,</span> 
    Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;J&quot;</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;K&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;L&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    Node<span class="token punctuation">:</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;N&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Node<span class="token punctuation">:</span><span class="token function">leaf</span><span class="token punctuation">(</span><span class="token string">&quot;O&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

<span class="token keyword">let </span>preorder <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>node<span class="token punctuation">]</span>
  <span class="token keyword keyword-if">if</span> node !<span class="token operator">=</span> <span class="token keyword keyword-nil">nil</span> <span class="token keyword keyword-then">then</span>
    <span class="token function">print</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token function">preorder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token function">preorder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span>
  <span class="token keyword keyword-end">end</span>

<span class="token keyword">let </span>inorder <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>node<span class="token punctuation">]</span>
  <span class="token keyword keyword-if">if</span> node !<span class="token operator">=</span> <span class="token keyword keyword-nil">nil</span> <span class="token keyword keyword-then">then</span>
    <span class="token function">inorder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span> <span class="token function">inorder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span>
  <span class="token keyword keyword-end">end</span>

<span class="token keyword">let </span>postorder <span class="token operator">=</span> <span class="token keyword">fun </span><span class="token punctuation">[</span>node<span class="token punctuation">]</span>
  <span class="token keyword keyword-if">if</span> node !<span class="token operator">=</span> <span class="token keyword keyword-nil">nil</span> <span class="token keyword keyword-then">then</span>
    <span class="token function">postorder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token function">postorder</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token string">&quot; &quot;</span><span class="token punctuation">)</span>
  <span class="token keyword keyword-end">end</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;preorder  &quot;</span><span class="token punctuation">)</span> <span class="token function">preorder</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span>  <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;inorder   &quot;</span><span class="token punctuation">)</span> <span class="token function">inorder</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span>   <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;postorder &quot;</span><span class="token punctuation">)</span> <span class="token function">postorder</span><span class="token punctuation">(</span>tree<span class="token punctuation">)</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span>

</pre><h2 class="mume-header" id="6-grammar">6. Grammar</h2>

<p>The following is the grammar of LoT, in an EBNF-style form</p>
<pre data-role="codeBlock" data-info="bnf" class="language-bnf"># Original file: presentation/grammar.bnf
block <span class="token operator">::=</span> <span class="token operator">(</span> expr <span class="token string">&quot;;&quot;</span><span class="token operator">?</span> <span class="token operator">)</span><span class="token operator">*</span>

expr <span class="token operator">::=</span> <span class="token string">&quot;do&quot;</span> block <span class="token string">&quot;end&quot;</span>
  <span class="token operator">|</span> <span class="token string">&quot;while&quot;</span> expr <span class="token string">&quot;do&quot;</span> block <span class="token string">&quot;end&quot;</span>
  <span class="token operator">|</span> <span class="token string">&quot;if&quot;</span> expr <span class="token string">&quot;then&quot;</span> block <span class="token operator">(</span> <span class="token string">&quot;elif&quot;</span> expr <span class="token string">&quot;then&quot;</span> block <span class="token operator">)</span><span class="token operator">*</span> <span class="token operator">(</span> <span class="token string">&quot;else&quot;</span> block <span class="token operator">)</span><span class="token operator">?</span> <span class="token string">&quot;end&quot;</span>
  <span class="token operator">|</span> <span class="token string">&quot;fun&quot;</span> <span class="token string">&quot;[&quot;</span> symlist<span class="token operator">?</span> <span class="token string">&quot;]&quot;</span> expr
  <span class="token operator">|</span> <span class="token string">&quot;let&quot;</span> SYMBOL <span class="token string">&quot;=&quot;</span> expr
  <span class="token operator">|</span> <span class="token string">&quot;return&quot;</span> expr
  <span class="token operator">|</span> assignment

exprlist   <span class="token operator">::=</span> expr <span class="token operator">(</span> <span class="token string">&quot;,&quot;</span> expr<span class="token operator">)</span><span class="token operator">*</span>
symlist    <span class="token operator">::=</span> SYMBOL <span class="token operator">(</span> <span class="token string">&quot;,&quot;</span> SYMBOL <span class="token operator">)</span><span class="token operator">*</span>
fieldlist  <span class="token operator">::=</span> fieldinit <span class="token operator">(</span> <span class="token string">&quot;,&quot;</span> fieldinit <span class="token operator">)</span><span class="token operator">*</span> <span class="token string">&quot;,&quot;</span><span class="token operator">?</span>
fieldinit  <span class="token operator">::=</span> <span class="token operator">(</span> field <span class="token string">&quot;=&quot;</span> <span class="token operator">)</span><span class="token operator">?</span> expr 
field      <span class="token operator">::=</span> <span class="token string">&quot;[&quot;</span> expr <span class="token string">&quot;]&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;.&quot;</span> SYMBOL

assignment <span class="token operator">::=</span> call <span class="token string">&quot;=&quot;</span> expr <span class="token operator">|</span> logic_or
logic_or   <span class="token operator">::=</span> logic_and <span class="token operator">(</span> <span class="token string">&quot;or&quot;</span> logic_and <span class="token operator">)</span>
logic_and  <span class="token operator">::=</span> equality <span class="token operator">(</span> <span class="token string">&quot;and&quot;</span> equality <span class="token operator">)</span><span class="token operator">*</span>
equality   <span class="token operator">::=</span> comparison <span class="token operator">(</span> <span class="token operator">(</span> <span class="token string">&quot;!=&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;==&quot;</span> <span class="token operator">)</span> comparison <span class="token operator">)</span><span class="token operator">*</span>
comparison <span class="token operator">::=</span> term <span class="token operator">(</span> <span class="token operator">(</span> <span class="token string">&quot;&gt;&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;&gt;=&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;&lt;&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;&lt;=&quot;</span> <span class="token operator">)</span> term <span class="token operator">)</span><span class="token operator">*</span>
term       <span class="token operator">::=</span> factor <span class="token operator">(</span> <span class="token operator">(</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;+&quot;</span> <span class="token operator">)</span> factor <span class="token operator">)</span><span class="token operator">*</span>
factor     <span class="token operator">::=</span> unary <span class="token operator">(</span> <span class="token operator">(</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;*&quot;</span> <span class="token operator">)</span> unary <span class="token operator">)</span><span class="token operator">*</span>
unary      <span class="token operator">::=</span> <span class="token operator">(</span> <span class="token string">&quot;!&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">)</span> unary <span class="token operator">|</span> call
call       <span class="token operator">::=</span> primary <span class="token operator">(</span> <span class="token string">&quot;(&quot;</span> exprlist<span class="token operator">?</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">|</span> field <span class="token operator">|</span> <span class="token string">&quot;:&quot;</span> SYMBOL <span class="token string">&quot;(&quot;</span> exprlist<span class="token operator">?</span> <span class="token string">&quot;)&quot;</span> <span class="token operator">)</span><span class="token operator">*</span>
primary    <span class="token operator">::=</span> <span class="token string">&quot;true&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;false&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;nil&quot;</span> <span class="token operator">|</span> NUMBER <span class="token operator">|</span> STRING <span class="token operator">|</span> SYMBOL <span class="token operator">|</span> <span class="token string">&quot;(&quot;</span> expr <span class="token string">&quot;)&quot;</span>
            <span class="token operator">|</span> <span class="token string">&quot;{&quot;</span> fieldlist<span class="token operator">?</span> <span class="token string">&quot;}&quot;</span> <span class="token operator">]</span> <span class="token operator">|</span> <span class="token string">&quot;[&quot;</span> exprlist<span class="token operator">?</span> <span class="token string">&quot;]&quot;</span>

NUMBER <span class="token operator">::=</span> DIGIT<span class="token operator">+</span> <span class="token operator">(</span> <span class="token string">&quot;.&quot;</span> DIGIT<span class="token operator">+</span> <span class="token operator">)</span><span class="token operator">?</span> 
STRING <span class="token operator">::=</span> <span class="token operator">(</span> <span class="token string">&quot;\&quot;</span><span class="token string">&quot; &lt;any char except &quot;</span>\<span class="token string">&quot;&quot;</span>&gt;<span class="token operator">*</span> <span class="token string">&quot;\&quot;</span>&quot; <span class="token operator">)</span>
SYMBOL <span class="token operator">::=</span> ALPHA <span class="token operator">(</span> ALPHA <span class="token operator">|</span> DIGIT <span class="token operator">)</span><span class="token operator">*</span> 
ALPHA <span class="token operator">::=</span> <span class="token string">&quot;a&quot;</span> <span class="token operator">...</span> <span class="token string">&quot;z&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;A&quot;</span> <span class="token operator">...</span> <span class="token string">&quot;Z&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;_&quot;</span> 
DIGIT <span class="token operator">::=</span> <span class="token string">&quot;0&quot;</span> <span class="token operator">...</span> <span class="token string">&quot;9&quot;</span> 
</pre>
      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>